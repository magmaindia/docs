

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Magma Services &mdash; Magma India Documentation 0.1.0 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Magma Services 5G" href="../../services/index.html" />
    <link rel="prev" title="Magma Services" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Magma India Documentation
          

          
            
            <img src="../../_static/magma-logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Magma 4G Virtual Labs</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../installation/index.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../architecture/index.html">Architecture</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Magma Services</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Magma Services</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#about-services">About Services</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#sctpd">1. SCTPd</a></li>
<li class="toctree-l5"><a class="reference internal" href="#mme">2. MME</a></li>
<li class="toctree-l5"><a class="reference internal" href="#enodebd">3. Enodebd</a></li>
<li class="toctree-l5"><a class="reference internal" href="#magmad">4. Magmad</a></li>
<li class="toctree-l5"><a class="reference internal" href="#dnsd">5. DNSd</a></li>
<li class="toctree-l5"><a class="reference internal" href="#subscriberdb">6. SubscriberDB</a></li>
<li class="toctree-l5"><a class="reference internal" href="#mobilityd">7. Mobilityd</a></li>
<li class="toctree-l5"><a class="reference internal" href="#directoryd">8. Directoryd</a></li>
<li class="toctree-l5"><a class="reference internal" href="#sessiond">9. Sessiond</a></li>
<li class="toctree-l5"><a class="reference internal" href="#policydb">10. PolicyDB</a></li>
<li class="toctree-l5"><a class="reference internal" href="#dpid">11. DPId</a></li>
<li class="toctree-l5"><a class="reference internal" href="#pipelined">12. Pipelined</a></li>
<li class="toctree-l5"><a class="reference internal" href="#events">13. Events</a></li>
<li class="toctree-l5"><a class="reference internal" href="#smsd">14. SMSd</a></li>
<li class="toctree-l5"><a class="reference internal" href="#ctraced">15. Ctraced</a></li>
<li class="toctree-l5"><a class="reference internal" href="#health-checker">16. Health checker</a></li>
<li class="toctree-l5"><a class="reference internal" href="#control-proxy">17. Control proxy</a></li>
<li class="toctree-l5"><a class="reference internal" href="#header-enrichment">18. Header enrichment</a></li>
<li class="toctree-l5"><a class="reference internal" href="#dynamic-services">Dynamic services</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#monitord">1. Monitord</a></li>
<li class="toctree-l6"><a class="reference internal" href="#td-agent-bit">2. Td-agent-bit</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#datapath">Datapath</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../services/index.html">Magma Services 5G</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../5gLab/index.html">5G Virtual Lab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Magma_5gCore/index.html">5G Core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../OAI_5gCore/index.html">OAI 5G Core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Free5gc_5gCore/index.html">FREE5GC 5G Core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Open5gs_5gCore/index.html">OPEN5GS 5G Core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Magma_5gCore_SA/index.html">MAGMA 5G Core SA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../help.html">Help</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Magma India Documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Magma 4G Virtual Labs</a> &raquo;</li>
        
          <li><a href="index.html">Magma Services</a> &raquo;</li>
        
      <li>Magma Services</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            
              <a href="https://github.com/magmaindia/docs/blob/master/docs/labs/services/services.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="magma-services">
<h1>Magma Services<a class="headerlink" href="#magma-services" title="Permalink to this headline">¶</a></h1>
<a class="reference internal image-reference" href="../../_images/service1.png"><img alt="Alternative text" src="../../_images/service1.png" style="width: 800px;" /></a>
<div class="section" id="about-services">
<h2>About Services<a class="headerlink" href="#about-services" title="Permalink to this headline">¶</a></h2>
<div class="section" id="sctpd">
<h3>1. SCTPd<a class="headerlink" href="#sctpd" title="Permalink to this headline">¶</a></h3>
<p>sctpd service. Termination service for the SCTP connections currently used for S1-C and N2 interfaces. It decouples application layers of 3GPP control signaling from the SCTP communication. Restarts of other AGW services do not impact this service in stateless mode, hence it preserves RAN connections upon application crashes or software updates. Restart of this service forces all the other major AGW services to restart.</p>
</div>
<div class="section" id="mme">
<h3>2. MME<a class="headerlink" href="#mme" title="Permalink to this headline">¶</a></h3>
<p>mme service. Implements S1AP, NAS and MME subcomponents for LTE control plane. Also implements SGW and PGW control plane. If the mme service is restarted, S1 connection will be restarted and users service will be affected unless the AGW is in stateless mode. Mobilityd, pipelined, and sessiond are restarted in this process as well.</p>
</div>
<div class="section" id="enodebd">
<h3>3. Enodebd<a class="headerlink" href="#enodebd" title="Permalink to this headline">¶</a></h3>
<p>enodebd service. Enodebd supports management of eNodeB devices that use TR-069 as a management interface. This is an optional service that is not used in the case of unmanaged eNBs. This is used for both provisioning the eNodeB and collecting the performance metrics. It also acts as a statistics reporter for externally managed eNodeBs. It supports the following data models.
Device Data model: TR-181, TR-098
Information Data model: TR-196</p>
</div>
<div class="section" id="magmad">
<h3>4. Magmad<a class="headerlink" href="#magmad" title="Permalink to this headline">¶</a></h3>
<p>magmad service. Parent service to start all Magma services, owns the collection and reporting of metrics of services, and also acts as the bootstrapping client with Orchestrator.</p>
</div>
<div class="section" id="dnsd">
<h3>5. DNSd<a class="headerlink" href="#dnsd" title="Permalink to this headline">¶</a></h3>
<p>dnsd service. Local DNS and DHCP server for the eNodeB.</p>
</div>
<div class="section" id="subscriberdb">
<h3>6. SubscriberDB<a class="headerlink" href="#subscriberdb" title="Permalink to this headline">¶</a></h3>
<p>subscriberdb service. Magma uses SubscriberDB to enable LTE data services through one network node like AGW for LTE subscribers. It is bypassed for the deployments that make use of the MNO’s HSS.
It supports the following two S6a procedures
S6a: Authentication Information Request and Answer (AIR/AIA)
S6a: Update Location Request and Answer (ULR/ULA)
SubscriberDB also supports these additional functions</p>
<p>Interface with Orchestrator to receive subscriber information such as IMSI, secret key (K), OP, user-profile during system bring-up
Generate authentication vectors using Milenage algorithm and share these with MME
Share user profile with MME</p>
</div>
<div class="section" id="mobilityd">
<h3>7. Mobilityd<a class="headerlink" href="#mobilityd" title="Permalink to this headline">¶</a></h3>
<p>mobilityd service. IP address management service. It primarily functions as an interface with the Orchestrator to receive an IP address block during system bring-up. The service can allocate and release IP addresses for the subscriber on the request from S-PGW Control Plane.</p>
</div>
<div class="section" id="directoryd">
<h3>8. Directoryd<a class="headerlink" href="#directoryd" title="Permalink to this headline">¶</a></h3>
<p>directoryd service. Lookup service where you are able to push different keys and attribute pairs for each key. Commonly used keys include subscriber ID and session ID.</p>
</div>
<div class="section" id="sessiond">
<h3>9. Sessiond<a class="headerlink" href="#sessiond" title="Permalink to this headline">¶</a></h3>
<p>sessiond service. Sessiond implements the control plane for the PCEF functionality in Magma. Sessiond is responsible for the lifecycle management of the session state (credit and rules) associated with a user. It interacts with the PCEF datapath through pipelined for L2-L4 and DPId for L4-L7 policies.</p>
</div>
<div class="section" id="policydb">
<h3>10. PolicyDB<a class="headerlink" href="#policydb" title="Permalink to this headline">¶</a></h3>
<p>policydb service. PolicyDB is the service that supports static PCRF rules. This service runs in both the AGW and the orchestrator. Rules managed through the rest API are streamed to the PolicyDB instances on the AGW. Sessiond ensures these policies are implemented as specified.</p>
</div>
<div class="section" id="dpid">
<h3>11. DPId<a class="headerlink" href="#dpid" title="Permalink to this headline">¶</a></h3>
<p>dpid service. Deep packet inspection service to enforce policy rules.</p>
</div>
<div class="section" id="pipelined">
<h3>12. Pipelined<a class="headerlink" href="#pipelined" title="Permalink to this headline">¶</a></h3>
<p>pipelined service. Pipelined is the control application that programs the OVS OpenFlow rules. Pipelined is a set of services that are chained together. These services can be chained and enabled/disabled through the REST API. If pipelined is restarted, users service will be affected.</p>
</div>
<div class="section" id="events">
<h3>13. Events<a class="headerlink" href="#events" title="Permalink to this headline">¶</a></h3>
<p>eventd service. Service that acts like an intermediary for different magma services, using the service303 interface, it will receive and push the generated registered events to the td-agent-bit service on the gateway, so these can be then later sent to Orchestrator. These events will be sent to ElasticSearch where they can be queried.</p>
</div>
<div class="section" id="smsd">
<h3>14. SMSd<a class="headerlink" href="#smsd" title="Permalink to this headline">¶</a></h3>
<p>smsd service. service that functions as the AGW interface that will sync the SMS information with Orchestrator.</p>
</div>
<div class="section" id="ctraced">
<h3>15. Ctraced<a class="headerlink" href="#ctraced" title="Permalink to this headline">¶</a></h3>
<p>ctraced service. Service used for managing call tracing on the AGW. The Tshark tool is used for packet capture and filtering. Packet captures are sent back to the Orchestrator and viewable on the NMS. Preferred usage for call tracing is through the NMS.</p>
</div>
<div class="section" id="health-checker">
<h3>16. Health checker<a class="headerlink" href="#health-checker" title="Permalink to this headline">¶</a></h3>
<p>health service. Health checker service that verifies the state on MME, mobilityd, sessiond and pipelined and cleans corrupt state if necessary.</p>
</div>
<div class="section" id="control-proxy">
<h3>17. Control proxy<a class="headerlink" href="#control-proxy" title="Permalink to this headline">¶</a></h3>
<p>control_proxy service. Control proxy manages the network transport between the gateways and the controller (Orchestrator). It also provides the following functionality
Abstract service addressing by providing a service registry, mapping a user-addressable name to its remote IP and port
Push all traffic over HTTP/2, encrypted using TLS. The traffic is routed to individual services by encoding the service name in the HTTP/2 authority header.
Individual gRPC calls between a gateway and the controller are multiplexed over the same HTTP/2 connection, avoiding connection setup time per RPC call</p>
</div>
<div class="section" id="header-enrichment">
<h3>18. Header enrichment<a class="headerlink" href="#header-enrichment" title="Permalink to this headline">¶</a></h3>
<p>There are two services within header enrichment: the envoy controller and envoy_dp. Envoy functions as the de facto HTTP proxy used for service mesh and can be programmed via the gRPC API. Additionally, the Envoy dataplane can scale up and scale down according to resources on AGW. The envoy controller is programmed by pipelined according to the set of rules in place.</p>
</div>
<div class="section" id="dynamic-services">
<h3>Dynamic services<a class="headerlink" href="#dynamic-services" title="Permalink to this headline">¶</a></h3>
<p>Dynamic services are optional AGW services that must be enabled by updating the AGW’s magmad configuration.</p>
<div class="section" id="monitord">
<h4>1. Monitord<a class="headerlink" href="#monitord" title="Permalink to this headline">¶</a></h4>
<p>monitord service. Monitors the CPEs connected to the AGW. Sends ICMP pings to the CPEs connected to the gateway and reports liveness metrics.</p>
</div>
<div class="section" id="td-agent-bit">
<h4>2. Td-agent-bit<a class="headerlink" href="#td-agent-bit" title="Permalink to this headline">¶</a></h4>
<p>td-agent-bit service. Enables log aggregation and event logging where it takes input from syslog and the events service and forwards the output to the Orchestrator. It is received on the Orchestrator by Fluentd then stored in Elasticsearch.</p>
</div>
</div>
</div>
<div class="section" id="datapath">
<h2>Datapath<a class="headerlink" href="#datapath" title="Permalink to this headline">¶</a></h2>
<p>Magma Gateway uses linux networking stack and OVS to program packet pipeline on the gateway. OVS gives us tremendous programmability to classify and process packets on the gateway.</p>
<p>OVS configuration has two major component</p>
<p>Ports: AGW mostly uses static ports. OVSDB configuration is done at deployment time. All endpoint are dynamically learned in openflow pipeline.
Flows: AGW configures flows primarily via pipelineD. First table is configured by MME.</p>
<p><code class="docutils literal notranslate"><span class="pre">Bridges</span> <span class="pre">&amp;</span> <span class="pre">Interfaces</span></code></p>
<a class="reference internal image-reference" href="../../_images/bridges-interface.png"><img alt="Alternative text" src="../../_images/bridges-interface.png" style="width: 800px;" /></a>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="../../services/index.html" class="btn btn-neutral float-right" title="Magma Services 5G" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="index.html" class="btn btn-neutral float-left" title="Magma Services" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2022, Magma India.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>